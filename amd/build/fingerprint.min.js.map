{"version":3,"file":"fingerprint.min.js","sources":["../src/fingerprint.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Technical fingerprinting module for agent detection.\n *\n * Collects browser fingerprint data to identify automation tools,\n * headless browsers, and known AI/automation extensions.\n *\n * @module     local_agentdetect/fingerprint\n * @copyright  2024 Your Institution\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * Comet agent extension ID (Perplexity's agentic browser).\n *\n * @type {string}\n */\nconst COMET_EXTENSION_ID = 'npclhjbddhklpbnacpjloidibaggcgon';\n\n/**\n * Paths to probe within the Comet extension for resource detection.\n *\n * @type {Array<string>}\n */\nconst COMET_RESOURCE_PATHS = [\n    'icon.png',\n    'icons/icon128.png',\n    'icons/icon48.png',\n    'overlay.js',\n];\n\n/**\n * Initial webdriver state at module load time.\n * Used to detect mid-session debugger attachment.\n *\n * @type {boolean}\n */\nconst initialWebdriverState = navigator.webdriver;\n\n/**\n * Known automation extension identifiers.\n *\n * Format: {id: 'extension-id', name: 'Human readable name', weight: score_weight}\n * Weight indicates how strong an indicator this extension is (1-10).\n *\n * @type {Array<{id: string, name: string, weight: number}>}\n */\nconst KNOWN_EXTENSIONS = [\n    // AI Agents & Browser Automation.\n    {id: COMET_EXTENSION_ID, name: 'Comet Agent (Perplexity)', weight: 10, pattern: /comet.*agent|perplexity/i},\n    {id: 'claudeinchrome', name: 'Claude in Chrome (MCP)', weight: 10, pattern: /claude.*mcp|mcp.*claude/i},\n    {id: 'anthropic', name: 'Anthropic Browser Agent', weight: 10, pattern: /anthropic/i},\n\n    // Anti-detection / AI bypass tools.\n    {id: 'undetectable', name: 'Undetectable.ai', weight: 9, pattern: /undetectable/i},\n    {id: 'gofingerprint', name: 'GoLogin Fingerprint', weight: 8, pattern: /gologin/i},\n    {id: 'multilogin', name: 'MultiLogin', weight: 8, pattern: /multilogin/i},\n\n    // Browser automation.\n    {id: 'selenium', name: 'Selenium IDE', weight: 10, pattern: /selenium/i},\n    {id: 'puppeteer', name: 'Puppeteer Recorder', weight: 9, pattern: /puppeteer/i},\n    {id: 'playwright', name: 'Playwright Inspector', weight: 9, pattern: /playwright/i},\n    {id: 'imacros', name: 'iMacros', weight: 8, pattern: /imacros/i},\n    {id: 'browserflow', name: 'Browserflow', weight: 8, pattern: /browserflow/i},\n    {id: 'axiom', name: 'Axiom.ai', weight: 8, pattern: /axiom/i},\n    {id: 'browseai', name: 'Browse AI', weight: 8, pattern: /browse.*ai/i},\n    {id: 'bardeen', name: 'Bardeen', weight: 7, pattern: /bardeen/i},\n\n    // Script injection.\n    {id: 'tampermonkey', name: 'Tampermonkey', weight: 5, pattern: /tampermonkey/i},\n    {id: 'greasemonkey', name: 'Greasemonkey', weight: 5, pattern: /greasemonkey/i},\n    {id: 'violentmonkey', name: 'Violentmonkey', weight: 5, pattern: /violentmonkey/i},\n];\n\n/**\n * Global objects injected by automation tools.\n *\n * @type {Array<{name: string, weight: number}>}\n */\nconst AUTOMATION_GLOBALS = [\n    {name: 'webdriver', weight: 10},\n    {name: '__webdriver_evaluate', weight: 10},\n    {name: '__selenium_evaluate', weight: 10},\n    {name: '__webdriver_script_function', weight: 10},\n    {name: '__webdriver_script_func', weight: 10},\n    {name: '__webdriver_script_fn', weight: 10},\n    {name: '__fxdriver_evaluate', weight: 10},\n    {name: '__driver_unwrapped', weight: 10},\n    {name: '__webdriver_unwrapped', weight: 10},\n    {name: '__driver_evaluate', weight: 10},\n    {name: '__selenium_unwrapped', weight: 10},\n    {name: '__fxdriver_unwrapped', weight: 10},\n    {name: '_phantom', weight: 9},\n    {name: '__nightmare', weight: 9},\n    {name: '_selenium', weight: 10},\n    {name: 'callSelenium', weight: 10},\n    {name: 'callPhantom', weight: 9},\n    {name: '_Selenium_IDE_Recorder', weight: 10},\n    {name: '__playwright', weight: 10},\n    {name: '__puppeteer', weight: 10},\n    {name: 'cdc_adoQpoasnfa76pfcZLmcfl_Array', weight: 10}, // Chrome DevTools Protocol marker.\n    {name: 'cdc_adoQpoasnfa76pfcZLmcfl_Promise', weight: 10},\n    {name: 'cdc_adoQpoasnfa76pfcZLmcfl_Symbol', weight: 10},\n    {name: 'iMacros', weight: 8},\n    {name: 'GM_info', weight: 5}, // Greasemonkey/Tampermonkey.\n    {name: 'GM_getValue', weight: 5},\n    {name: 'GM_setValue', weight: 5},\n];\n\n/**\n * DOM attributes that indicate automation tool injection.\n *\n * @type {Array<{selector: string, attribute: string, pattern: RegExp, name: string, weight: number}>}\n */\nconst DOM_MARKERS = [\n    {selector: '[data-mcp]', attribute: 'data-mcp', pattern: /.+/, name: 'MCP data attribute', weight: 10},\n    {selector: '[data-claude]', attribute: 'data-claude', pattern: /.+/, name: 'Claude data attribute', weight: 10},\n    {selector: '[data-anthropic]', attribute: 'data-anthropic', pattern: /.+/, name: 'Anthropic marker', weight: 10},\n    {selector: '[data-selenium]', attribute: 'data-selenium', pattern: /.+/, name: 'Selenium marker', weight: 10},\n    {\n        selector: '[data-testid]',\n        attribute: 'data-testid',\n        pattern: /^(selenium|cypress|playwright)/i,\n        name: 'Test framework ID',\n        weight: 7,\n    },\n    {selector: '[data-cy]', attribute: 'data-cy', pattern: /.+/, name: 'Cypress marker', weight: 7},\n    {selector: '[data-automation]', attribute: 'data-automation', pattern: /.+/, name: 'Automation marker', weight: 8},\n    {selector: '[data-puppeteer]', attribute: 'data-puppeteer', pattern: /.+/, name: 'Puppeteer marker', weight: 9},\n];\n\n/**\n * Collect all technical fingerprint signals.\n *\n * @returns {Promise<Object>} Fingerprint data with detected signals and scores.\n */\nexport const collect = async() => {\n    const signals = {\n        timestamp: Date.now(),\n        webdriver: detectWebdriver(),\n        headless: detectHeadless(),\n        extensions: await detectExtensions(),\n        cometExtension: await detectCometExtension(),\n        cometRuntime: detectCometRuntimeArtifacts(),\n        perplexityNetwork: detectPerplexityNetwork(),\n        globals: detectAutomationGlobals(),\n        domMarkers: detectDomMarkers(),\n        canvas: await collectCanvasFingerprint(),\n        webgl: collectWebGLInfo(),\n        navigator: collectNavigatorInfo(),\n    };\n\n    signals.score = calculateFingerprintScore(signals);\n\n    return signals;\n};\n\n/**\n * Detect WebDriver flag in navigator.\n *\n * @returns {Object} WebDriver detection results.\n */\nconst detectWebdriver = () => {\n    const results = {\n        detected: false,\n        signals: [],\n    };\n\n    // Standard webdriver property.\n    if (navigator.webdriver === true) {\n        results.detected = true;\n        results.signals.push({name: 'navigator.webdriver', value: true, weight: 10});\n    }\n\n    // Check for webdriver state changing mid-session (debugger attachment).\n    if (navigator.webdriver === true && initialWebdriverState === false) {\n        results.detected = true;\n        results.signals.push({name: 'webdriver.changed_mid_session', value: true, weight: 10});\n    }\n\n    // Check for webdriver in prototype chain (some tools hide it).\n    try {\n        const descriptor = Object.getOwnPropertyDescriptor(Navigator.prototype, 'webdriver');\n        if (descriptor && descriptor.get) {\n            const getter = descriptor.get.toString();\n            if (getter.includes('native code') === false) {\n                results.detected = true;\n                results.signals.push({name: 'webdriver.getter.modified', value: true, weight: 9});\n            }\n        }\n    } catch (e) {\n        // Property access error could indicate tampering.\n        results.signals.push({name: 'webdriver.access.error', value: e.message, weight: 3});\n    }\n\n    return results;\n};\n\n/**\n * Detect headless browser indicators.\n *\n * @returns {Object} Headless detection results.\n */\nconst detectHeadless = () => {\n    const results = {\n        detected: false,\n        signals: [],\n    };\n\n    // Check for missing plugins (headless often has 0).\n    if (navigator.plugins.length === 0) {\n        results.signals.push({name: 'plugins.empty', value: true, weight: 6});\n    }\n\n    // Check for missing languages.\n    if (!navigator.languages || navigator.languages.length === 0) {\n        results.detected = true;\n        results.signals.push({name: 'languages.empty', value: true, weight: 7});\n    }\n\n    // Chrome-specific: missing chrome object.\n    if (window.chrome === undefined && /Chrome/.test(navigator.userAgent)) {\n        results.detected = true;\n        results.signals.push({name: 'chrome.missing', value: true, weight: 8});\n    }\n\n    // Check for headless in user agent.\n    if (/HeadlessChrome|PhantomJS|SlimerJS/.test(navigator.userAgent)) {\n        results.detected = true;\n        results.signals.push({name: 'useragent.headless', value: true, weight: 10});\n    }\n\n    // Check window dimensions (headless often has unusual sizes).\n    if (window.outerWidth === 0 || window.outerHeight === 0) {\n        results.detected = true;\n        results.signals.push({name: 'window.dimensions.zero', value: true, weight: 8});\n    }\n\n    // Check for missing screen properties.\n    if (screen.availWidth === 0 || screen.availHeight === 0) {\n        results.signals.push({name: 'screen.dimensions.zero', value: true, weight: 7});\n    }\n\n    // Connection type check (headless often missing).\n    const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;\n    if (connection === undefined && /Chrome/.test(navigator.userAgent)) {\n        results.signals.push({name: 'connection.missing', value: true, weight: 4});\n    }\n\n    // Check for permission API behavior.\n    if (navigator.permissions) {\n        navigator.permissions.query({name: 'notifications'}).then((result) => {\n            // Headless often returns 'denied' instantly without prompting.\n            if (result.state === 'denied') {\n                results.signals.push({name: 'permissions.notifications.denied', value: true, weight: 3});\n            }\n            return result;\n        }).catch(() => {\n            // Ignore permission errors.\n        });\n    }\n\n    results.detected = results.signals.some((s) => s.weight >= 7);\n\n    return results;\n};\n\n/**\n * Scan stylesheets for known extension URLs.\n *\n * @param {Object} results Results object to populate.\n */\nconst scanExtensionStylesheets = (results) => {\n    const stylesheets = Array.from(document.styleSheets);\n    for (const sheet of stylesheets) {\n        try {\n            if (!sheet.href || !sheet.href.startsWith('chrome-extension://')) {\n                continue;\n            }\n            const matchedExt = KNOWN_EXTENSIONS.find((ext) => ext.pattern.test(sheet.href));\n            if (matchedExt) {\n                results.detected.push(matchedExt.name);\n                results.signals.push({\n                    name: `extension.stylesheet.${matchedExt.id}`,\n                    value: sheet.href,\n                    weight: matchedExt.weight,\n                });\n            }\n        } catch (e) {\n            // Cross-origin stylesheet, can't inspect.\n        }\n    }\n};\n\n/**\n * Detect known automation extensions.\n *\n * @returns {Promise<Object>} Extension detection results.\n */\nconst detectExtensions = async() => {\n    const results = {\n        detected: [],\n        signals: [],\n    };\n\n    // Method 1: Check for extension-injected elements.\n    for (const ext of KNOWN_EXTENSIONS) {\n        // Look for elements with extension-specific classes or IDs.\n        const elements = document.querySelectorAll(`[class*=\"${ext.id}\"], [id*=\"${ext.id}\"]`);\n        if (elements.length > 0) {\n            results.detected.push(ext.name);\n            results.signals.push({\n                name: `extension.dom.${ext.id}`,\n                value: elements.length,\n                weight: ext.weight,\n            });\n        }\n    }\n\n    // Method 2: Check for extension resource accessibility.\n    // Extensions often expose resources at chrome-extension:// URLs.\n    // Note: Direct probing disabled due to CORS restrictions.\n    // Future: Could probe known extension resource URLs.\n\n    // Method 3: Check for MCP-specific patterns.\n    if (typeof window.__MCP_READY !== 'undefined' || document.querySelector('[data-mcp-session]')) {\n        results.detected.push('MCP Protocol');\n        results.signals.push({name: 'mcp.protocol.detected', value: true, weight: 10});\n    }\n\n    // Method 4: Check for Anthropic/Claude-specific globals or patterns.\n    if (window.__CLAUDE_BROWSER_CONTEXT || window.__ANTHROPIC_SESSION) {\n        results.detected.push('Claude Browser Context');\n        results.signals.push({name: 'claude.context.detected', value: true, weight: 10});\n    }\n\n    // Method 5: Scan for injected stylesheets from extensions.\n    scanExtensionStylesheets(results);\n\n    return results;\n};\n\n/**\n * Detect automation-related global objects.\n *\n * @returns {Object} Global object detection results.\n */\nconst detectAutomationGlobals = () => {\n    const results = {\n        detected: [],\n        signals: [],\n    };\n\n    for (const global of AUTOMATION_GLOBALS) {\n        if (global.name in window) {\n            results.detected.push(global.name);\n            results.signals.push({\n                name: `global.${global.name}`,\n                value: true,\n                weight: global.weight,\n            });\n        }\n    }\n\n    // Check document properties (including non-enumerable) for CDP artifacts.\n    try {\n        const docPropNames = Object.getOwnPropertyNames(document);\n        for (const key of docPropNames) {\n            if (/^(\\$?cdc_|_cdc_|\\$chrome_asyncScriptInfo)/.test(key)) {\n                results.detected.push(key);\n                results.signals.push({name: `document.cdp.${key}`, value: true, weight: 10});\n            }\n        }\n    } catch (e) {\n        // Some environments may restrict getOwnPropertyNames.\n    }\n\n    return results;\n};\n\n/**\n * Detect DOM markers injected by automation tools.\n *\n * @returns {Object} DOM marker detection results.\n */\nconst detectDomMarkers = () => {\n    const results = {\n        detected: [],\n        signals: [],\n    };\n\n    for (const marker of DOM_MARKERS) {\n        const elements = document.querySelectorAll(marker.selector);\n        for (const el of elements) {\n            const value = el.getAttribute(marker.attribute);\n            if (marker.pattern.test(value)) {\n                results.detected.push(marker.name);\n                results.signals.push({\n                    name: `dom.${marker.attribute}`,\n                    value: value,\n                    weight: marker.weight,\n                });\n            }\n        }\n    }\n\n    return results;\n};\n\n/**\n * Detect Perplexity Comet agent extension presence.\n *\n * Probes for the comet-agent extension by attempting to load known resources\n * and scanning the DOM for extension artifacts.\n *\n * @returns {Promise<Object>} Comet extension detection results.\n */\nconst detectCometExtension = async() => {\n    const results = {\n        detected: false,\n        isAgentic: false,\n        signals: [],\n    };\n\n    // Check sessionStorage cache from prior page.\n    try {\n        if (sessionStorage.getItem('agentdetect_comet_detected') === 'true') {\n            results.detected = true;\n            results.signals.push({name: 'comet.extension.cached', value: true, weight: 10});\n        }\n    } catch (e) {\n        // Ignore.\n    }\n\n    // Scan existing scripts and links for the extension ID.\n    const scripts = document.querySelectorAll('script[src*=\"' + COMET_EXTENSION_ID + '\"]');\n    if (scripts.length > 0) {\n        results.detected = true;\n        results.isAgentic = true; // Script injection means agent is active.\n        results.signals.push({\n            name: 'comet.extension.script_injected',\n            value: scripts[0].src,\n            weight: 10,\n        });\n    }\n\n    const links = document.querySelectorAll('link[href*=\"' + COMET_EXTENSION_ID + '\"]');\n    if (links.length > 0) {\n        results.detected = true;\n        results.signals.push({\n            name: 'comet.extension.link_injected',\n            value: links[0].href,\n            weight: 10,\n        });\n    }\n\n    // Scan stylesheets for the extension ID.\n    try {\n        for (const sheet of document.styleSheets) {\n            if (sheet.href && sheet.href.includes(COMET_EXTENSION_ID)) {\n                results.detected = true;\n                results.signals.push({\n                    name: 'comet.extension.stylesheet',\n                    value: sheet.href,\n                    weight: 10,\n                });\n            }\n        }\n    } catch (e) {\n        // Cross-origin stylesheet.\n    }\n\n    // Probe extension resources via Image load.\n    if (!results.detected) {\n        const probeResult = await probeExtensionResource();\n        if (probeResult) {\n            results.detected = true;\n            results.signals.push({\n                name: 'comet.extension.resource_probe',\n                value: probeResult,\n                weight: 10,\n            });\n        }\n    }\n\n    // Cache detection result for subsequent pages.\n    if (results.detected) {\n        try {\n            sessionStorage.setItem('agentdetect_comet_detected', 'true');\n        } catch (e) {\n            // Ignore.\n        }\n    }\n\n    return results;\n};\n\n/**\n * Attempt to load a resource from the Comet extension.\n *\n * @returns {Promise<string|null>} Path that loaded successfully, or null.\n */\nconst probeExtensionResource = async() => {\n    const baseUrl = `chrome-extension://${COMET_EXTENSION_ID}/`;\n\n    /**\n     * Try loading a single image resource.\n     *\n     * @param {string} path Resource path to probe.\n     * @returns {Promise<string|null>} The path if loaded, null otherwise.\n     */\n    const probeSingle = (path) => {\n        return new Promise((resolve) => {\n            const img = new Image();\n            const timer = setTimeout(() => resolve(null), 1000);\n            img.onload = () => {\n                clearTimeout(timer);\n                resolve(path);\n            };\n            img.onerror = () => {\n                clearTimeout(timer);\n                resolve(null);\n            };\n            img.src = baseUrl + path;\n        });\n    };\n\n    try {\n        const results = await Promise.all(COMET_RESOURCE_PATHS.map(probeSingle));\n        return results.find((r) => r !== null) || null;\n    } catch (e) {\n        return null;\n    }\n};\n\n/**\n * Detect network connections to Perplexity AI agent infrastructure.\n *\n * Note: WebSocket connections from the extension's service worker don't appear\n * in the page's performance entries. We check both resource entries and for\n * broader perplexity.ai connections (e.g. suggest API, CDN).\n *\n * @returns {Object} Network detection results.\n */\nconst detectPerplexityNetwork = () => {\n    const results = {\n        detected: false,\n        signals: [],\n    };\n\n    try {\n        const entries = performance.getEntriesByType('resource');\n        for (const entry of entries) {\n            if (/perplexity\\.ai/i.test(entry.name)) {\n                results.detected = true;\n                const isAgent = /\\/(agent|rest\\/sse)/i.test(entry.name);\n                results.signals.push({\n                    name: isAgent ? 'network.perplexity_agent' : 'network.perplexity_resource',\n                    value: entry.name,\n                    weight: isAgent ? 9 : 6,\n                });\n            }\n        }\n    } catch (e) {\n        // PerformanceObserver not available.\n    }\n\n    return results;\n};\n\n/**\n * Detect Comet-specific runtime artifacts.\n *\n * Comet's chrome.debugger attachment and content scripts leave observable\n * side effects even though they run in isolated worlds.\n *\n * @returns {Object} Detection results.\n */\nconst detectCometRuntimeArtifacts = () => {\n    const results = {\n        detected: false,\n        signals: [],\n    };\n\n    // Check 1: chrome.debugger attachment may set navigator.webdriver at runtime.\n    // We already track this via initialWebdriverState, but also check for\n    // the debugger-attached timing behavior: events dispatched via CDP\n    // have isTrusted=true but arrive without natural input event chains.\n\n    // Check 2: Look for Comet's content script side effects in inline styles.\n    try {\n        const allElements = document.querySelectorAll(`[style*=\"${COMET_EXTENSION_ID}\"]`);\n        if (allElements.length > 0) {\n            results.detected = true;\n            results.signals.push({\n                name: 'comet.runtime.inline_style',\n                value: allElements[0].tagName,\n                weight: 10,\n            });\n        }\n    } catch (e) {\n        // Ignore scan errors.\n    }\n\n    // Check 3: Look for Web Accessible Resources from Comet's extensions.\n    try {\n        const cometScripts = document.querySelectorAll(\n            'script[src*=\"chrome-extension://\"]'\n        );\n        for (const script of cometScripts) {\n            const src = script.src || '';\n            const isComet = src.includes(COMET_EXTENSION_ID) || src.includes('perplexity') || src.includes('comet');\n            if (!isComet) {\n                continue;\n            }\n            results.detected = true;\n            results.signals.push({name: 'comet.runtime.script', value: src, weight: 10});\n        }\n    } catch (e) {\n        // Ignore.\n    }\n\n    // Check 4: Check if window has Comet-specific properties.\n    // Extensions that use window.postMessage or exposeInMainWorld may leak globals.\n    const cometGlobals = ['__comet__', '__perplexity__', '__pplx__', 'cometAgent', 'perplexityAgent'];\n    for (const name of cometGlobals) {\n        if (name in window) {\n            results.detected = true;\n            results.signals.push({\n                name: 'comet.runtime.global',\n                value: name,\n                weight: 10,\n            });\n        }\n    }\n\n    return results;\n};\n\n/**\n * Collect canvas fingerprint for headless detection.\n *\n * Headless browsers often have different canvas rendering.\n *\n * @returns {Promise<Object>} Canvas fingerprint data.\n */\nconst collectCanvasFingerprint = async() => {\n    const results = {\n        hash: null,\n        anomalies: [],\n    };\n\n    try {\n        const canvas = document.createElement('canvas');\n        canvas.width = 200;\n        canvas.height = 50;\n        const ctx = canvas.getContext('2d');\n\n        // Draw complex shapes that reveal rendering differences.\n        ctx.textBaseline = 'top';\n        ctx.font = '14px Arial';\n        ctx.fillStyle = '#f60';\n        ctx.fillRect(125, 1, 62, 20);\n        ctx.fillStyle = '#069';\n        ctx.fillText('Agent Detection Test', 2, 15);\n        ctx.fillStyle = 'rgba(102, 204, 0, 0.7)';\n        ctx.fillText('Canvas Fingerprint', 4, 17);\n\n        const dataUrl = canvas.toDataURL();\n        results.hash = await hashString(dataUrl);\n\n        // Check for known headless canvas signatures.\n        if (dataUrl.length < 1000) {\n            results.anomalies.push({name: 'canvas.data.short', weight: 6});\n        }\n\n    } catch (e) {\n        results.anomalies.push({name: 'canvas.error', value: e.message, weight: 5});\n    }\n\n    return results;\n};\n\n/**\n * Collect WebGL renderer information.\n *\n * Headless browsers often report \"SwiftShader\" or unusual renderers.\n *\n * @returns {Object} WebGL information.\n */\nconst collectWebGLInfo = () => {\n    const results = {\n        vendor: null,\n        renderer: null,\n        anomalies: [],\n    };\n\n    try {\n        const canvas = document.createElement('canvas');\n        const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n\n        if (gl) {\n            const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');\n            if (debugInfo) {\n                results.vendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);\n                results.renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);\n\n                // Check for headless indicators.\n                const headlessRenderers = ['SwiftShader', 'llvmpipe', 'Mesa', 'Software'];\n                for (const hr of headlessRenderers) {\n                    if (results.renderer && results.renderer.includes(hr)) {\n                        results.anomalies.push({\n                            name: `webgl.renderer.${hr.toLowerCase()}`,\n                            value: results.renderer,\n                            weight: 8,\n                        });\n                    }\n                }\n            }\n        } else {\n            results.anomalies.push({name: 'webgl.unavailable', weight: 5});\n        }\n    } catch (e) {\n        results.anomalies.push({name: 'webgl.error', value: e.message, weight: 3});\n    }\n\n    return results;\n};\n\n/**\n * Collect navigator information for fingerprinting.\n *\n * @returns {Object} Navigator properties.\n */\nconst collectNavigatorInfo = () => {\n    return {\n        userAgent: navigator.userAgent,\n        platform: navigator.platform,\n        hardwareConcurrency: navigator.hardwareConcurrency,\n        deviceMemory: navigator.deviceMemory,\n        maxTouchPoints: navigator.maxTouchPoints,\n        languages: navigator.languages ? [...navigator.languages] : [],\n        cookieEnabled: navigator.cookieEnabled,\n        doNotTrack: navigator.doNotTrack,\n        pluginCount: navigator.plugins.length,\n    };\n};\n\n/**\n * Calculate overall fingerprint score.\n *\n * @param {Object} signals Collected signals.\n * @returns {number} Score from 0-100 (higher = more likely automated).\n */\nconst calculateFingerprintScore = (signals) => {\n    let totalWeight = 0;\n    let maxWeight = 0;\n\n    // Aggregate all signal weights.\n    const allSignals = [\n        ...(signals.webdriver.signals || []),\n        ...(signals.headless.signals || []),\n        ...(signals.extensions.signals || []),\n        ...(signals.cometExtension?.signals || []),\n        ...(signals.cometRuntime?.signals || []),\n        ...(signals.perplexityNetwork?.signals || []),\n        ...(signals.globals.signals || []),\n        ...(signals.domMarkers.signals || []),\n        ...(signals.canvas.anomalies || []),\n        ...(signals.webgl.anomalies || []),\n    ];\n\n    for (const signal of allSignals) {\n        totalWeight += signal.weight || 0;\n        maxWeight += 10; // Max possible weight per signal.\n    }\n\n    // Normalize to 0-100 scale.\n    if (maxWeight === 0) {\n        return 0;\n    }\n\n    // Use sigmoid-like scaling to emphasize high-confidence signals.\n    const rawScore = (totalWeight / Math.max(maxWeight, 50)) * 100;\n    return Math.min(100, Math.round(rawScore));\n};\n\n/**\n * Simple hash function for fingerprint comparison.\n *\n * @param {string} str String to hash.\n * @returns {Promise<string>} Hex hash string.\n */\nconst hashString = async(str) => {\n    const encoder = new TextEncoder();\n    const data = encoder.encode(str);\n    const hashBuffer = await crypto.subtle.digest('SHA-256', data);\n    const hashArray = Array.from(new Uint8Array(hashBuffer));\n    return hashArray.map((b) => b.toString(16).padStart(2, '0')).join('');\n};\n\nexport default {\n    collect,\n    KNOWN_EXTENSIONS,\n    AUTOMATION_GLOBALS,\n};\n"],"names":["COMET_EXTENSION_ID","COMET_RESOURCE_PATHS","initialWebdriverState","navigator","webdriver","KNOWN_EXTENSIONS","id","name","weight","pattern","AUTOMATION_GLOBALS","DOM_MARKERS","selector","attribute","collect","async","signals","timestamp","Date","now","detectWebdriver","headless","detectHeadless","extensions","detectExtensions","cometExtension","detectCometExtension","cometRuntime","detectCometRuntimeArtifacts","perplexityNetwork","detectPerplexityNetwork","globals","detectAutomationGlobals","domMarkers","detectDomMarkers","canvas","collectCanvasFingerprint","webgl","collectWebGLInfo","collectNavigatorInfo","score","calculateFingerprintScore","results","detected","push","value","descriptor","Object","getOwnPropertyDescriptor","Navigator","prototype","get","toString","includes","e","message","plugins","length","languages","undefined","window","chrome","test","userAgent","outerWidth","outerHeight","screen","availWidth","availHeight","connection","mozConnection","webkitConnection","permissions","query","then","result","state","catch","some","s","ext","elements","document","querySelectorAll","__MCP_READY","querySelector","__CLAUDE_BROWSER_CONTEXT","__ANTHROPIC_SESSION","stylesheets","Array","from","styleSheets","sheet","href","startsWith","matchedExt","find","scanExtensionStylesheets","global","docPropNames","getOwnPropertyNames","key","marker","el","getAttribute","isAgentic","sessionStorage","getItem","scripts","src","links","probeResult","probeExtensionResource","setItem","baseUrl","probeSingle","path","Promise","resolve","img","Image","timer","setTimeout","onload","clearTimeout","onerror","all","map","r","entries","performance","getEntriesByType","entry","isAgent","allElements","tagName","cometScripts","script","cometGlobals","hash","anomalies","createElement","width","height","ctx","getContext","textBaseline","font","fillStyle","fillRect","fillText","dataUrl","toDataURL","hashString","vendor","renderer","gl","debugInfo","getExtension","getParameter","UNMASKED_VENDOR_WEBGL","UNMASKED_RENDERER_WEBGL","headlessRenderers","hr","toLowerCase","platform","hardwareConcurrency","deviceMemory","maxTouchPoints","cookieEnabled","doNotTrack","pluginCount","totalWeight","maxWeight","allSignals","signal","rawScore","Math","max","min","round","data","TextEncoder","encode","str","hashBuffer","crypto","subtle","digest","Uint8Array","b","padStart","join"],"mappings":"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"}