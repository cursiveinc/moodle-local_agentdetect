{"version":3,"file":"fingerprint.min.js","sources":["../src/fingerprint.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Technical fingerprinting module for agent detection.\n *\n * Collects browser fingerprint data to identify automation tools,\n * headless browsers, and known AI/automation extensions.\n *\n * @module     local_agentdetect/fingerprint\n * @copyright  2024 Your Institution\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * Known automation extension identifiers.\n *\n * Format: {id: 'extension-id', name: 'Human readable name', weight: score_weight}\n * Weight indicates how strong an indicator this extension is (1-10).\n *\n * @type {Array<{id: string, name: string, weight: number}>}\n */\nconst KNOWN_EXTENSIONS = [\n    // AI Agents & Browser Automation.\n    {id: 'claudeinchrome', name: 'Claude in Chrome (MCP)', weight: 10, pattern: /claude.*mcp|mcp.*claude/i},\n    {id: 'anthropic', name: 'Anthropic Browser Agent', weight: 10, pattern: /anthropic/i},\n\n    // Anti-detection / AI bypass tools.\n    {id: 'undetectable', name: 'Undetectable.ai', weight: 9, pattern: /undetectable/i},\n    {id: 'gofingerprint', name: 'GoLogin Fingerprint', weight: 8, pattern: /gologin/i},\n    {id: 'multilogin', name: 'MultiLogin', weight: 8, pattern: /multilogin/i},\n\n    // Browser automation.\n    {id: 'selenium', name: 'Selenium IDE', weight: 10, pattern: /selenium/i},\n    {id: 'puppeteer', name: 'Puppeteer Recorder', weight: 9, pattern: /puppeteer/i},\n    {id: 'playwright', name: 'Playwright Inspector', weight: 9, pattern: /playwright/i},\n    {id: 'imacros', name: 'iMacros', weight: 8, pattern: /imacros/i},\n    {id: 'browserflow', name: 'Browserflow', weight: 8, pattern: /browserflow/i},\n    {id: 'axiom', name: 'Axiom.ai', weight: 8, pattern: /axiom/i},\n    {id: 'browseai', name: 'Browse AI', weight: 8, pattern: /browse.*ai/i},\n    {id: 'bardeen', name: 'Bardeen', weight: 7, pattern: /bardeen/i},\n\n    // Script injection.\n    {id: 'tampermonkey', name: 'Tampermonkey', weight: 5, pattern: /tampermonkey/i},\n    {id: 'greasemonkey', name: 'Greasemonkey', weight: 5, pattern: /greasemonkey/i},\n    {id: 'violentmonkey', name: 'Violentmonkey', weight: 5, pattern: /violentmonkey/i},\n];\n\n/**\n * Global objects injected by automation tools.\n *\n * @type {Array<{name: string, weight: number}>}\n */\nconst AUTOMATION_GLOBALS = [\n    {name: 'webdriver', weight: 10},\n    {name: '__webdriver_evaluate', weight: 10},\n    {name: '__selenium_evaluate', weight: 10},\n    {name: '__webdriver_script_function', weight: 10},\n    {name: '__webdriver_script_func', weight: 10},\n    {name: '__webdriver_script_fn', weight: 10},\n    {name: '__fxdriver_evaluate', weight: 10},\n    {name: '__driver_unwrapped', weight: 10},\n    {name: '__webdriver_unwrapped', weight: 10},\n    {name: '__driver_evaluate', weight: 10},\n    {name: '__selenium_unwrapped', weight: 10},\n    {name: '__fxdriver_unwrapped', weight: 10},\n    {name: '_phantom', weight: 9},\n    {name: '__nightmare', weight: 9},\n    {name: '_selenium', weight: 10},\n    {name: 'callSelenium', weight: 10},\n    {name: 'callPhantom', weight: 9},\n    {name: '_Selenium_IDE_Recorder', weight: 10},\n    {name: '__playwright', weight: 10},\n    {name: '__puppeteer', weight: 10},\n    {name: 'cdc_adoQpoasnfa76pfcZLmcfl_Array', weight: 10}, // Chrome DevTools Protocol marker.\n    {name: 'cdc_adoQpoasnfa76pfcZLmcfl_Promise', weight: 10},\n    {name: 'cdc_adoQpoasnfa76pfcZLmcfl_Symbol', weight: 10},\n    {name: 'iMacros', weight: 8},\n    {name: 'GM_info', weight: 5}, // Greasemonkey/Tampermonkey.\n    {name: 'GM_getValue', weight: 5},\n    {name: 'GM_setValue', weight: 5},\n];\n\n/**\n * DOM attributes that indicate automation tool injection.\n *\n * @type {Array<{selector: string, attribute: string, pattern: RegExp, name: string, weight: number}>}\n */\nconst DOM_MARKERS = [\n    {selector: '[data-mcp]', attribute: 'data-mcp', pattern: /.+/, name: 'MCP data attribute', weight: 10},\n    {selector: '[data-claude]', attribute: 'data-claude', pattern: /.+/, name: 'Claude data attribute', weight: 10},\n    {selector: '[data-anthropic]', attribute: 'data-anthropic', pattern: /.+/, name: 'Anthropic marker', weight: 10},\n    {selector: '[data-selenium]', attribute: 'data-selenium', pattern: /.+/, name: 'Selenium marker', weight: 10},\n    {\n        selector: '[data-testid]',\n        attribute: 'data-testid',\n        pattern: /^(selenium|cypress|playwright)/i,\n        name: 'Test framework ID',\n        weight: 7,\n    },\n    {selector: '[data-cy]', attribute: 'data-cy', pattern: /.+/, name: 'Cypress marker', weight: 7},\n    {selector: '[data-automation]', attribute: 'data-automation', pattern: /.+/, name: 'Automation marker', weight: 8},\n    {selector: '[data-puppeteer]', attribute: 'data-puppeteer', pattern: /.+/, name: 'Puppeteer marker', weight: 9},\n];\n\n/**\n * Collect all technical fingerprint signals.\n *\n * @returns {Promise<Object>} Fingerprint data with detected signals and scores.\n */\nexport const collect = async() => {\n    const signals = {\n        timestamp: Date.now(),\n        webdriver: detectWebdriver(),\n        headless: detectHeadless(),\n        extensions: await detectExtensions(),\n        globals: detectAutomationGlobals(),\n        domMarkers: detectDomMarkers(),\n        canvas: await collectCanvasFingerprint(),\n        webgl: collectWebGLInfo(),\n        navigator: collectNavigatorInfo(),\n    };\n\n    signals.score = calculateFingerprintScore(signals);\n\n    return signals;\n};\n\n/**\n * Detect WebDriver flag in navigator.\n *\n * @returns {Object} WebDriver detection results.\n */\nconst detectWebdriver = () => {\n    const results = {\n        detected: false,\n        signals: [],\n    };\n\n    // Standard webdriver property.\n    if (navigator.webdriver === true) {\n        results.detected = true;\n        results.signals.push({name: 'navigator.webdriver', value: true, weight: 10});\n    }\n\n    // Check for webdriver in prototype chain (some tools hide it).\n    try {\n        const descriptor = Object.getOwnPropertyDescriptor(Navigator.prototype, 'webdriver');\n        if (descriptor && descriptor.get) {\n            const getter = descriptor.get.toString();\n            if (getter.includes('native code') === false) {\n                results.detected = true;\n                results.signals.push({name: 'webdriver.getter.modified', value: true, weight: 9});\n            }\n        }\n    } catch (e) {\n        // Property access error could indicate tampering.\n        results.signals.push({name: 'webdriver.access.error', value: e.message, weight: 3});\n    }\n\n    return results;\n};\n\n/**\n * Detect headless browser indicators.\n *\n * @returns {Object} Headless detection results.\n */\nconst detectHeadless = () => {\n    const results = {\n        detected: false,\n        signals: [],\n    };\n\n    // Check for missing plugins (headless often has 0).\n    if (navigator.plugins.length === 0) {\n        results.signals.push({name: 'plugins.empty', value: true, weight: 6});\n    }\n\n    // Check for missing languages.\n    if (!navigator.languages || navigator.languages.length === 0) {\n        results.detected = true;\n        results.signals.push({name: 'languages.empty', value: true, weight: 7});\n    }\n\n    // Chrome-specific: missing chrome object.\n    if (window.chrome === undefined && /Chrome/.test(navigator.userAgent)) {\n        results.detected = true;\n        results.signals.push({name: 'chrome.missing', value: true, weight: 8});\n    }\n\n    // Check for headless in user agent.\n    if (/HeadlessChrome|PhantomJS|SlimerJS/.test(navigator.userAgent)) {\n        results.detected = true;\n        results.signals.push({name: 'useragent.headless', value: true, weight: 10});\n    }\n\n    // Check window dimensions (headless often has unusual sizes).\n    if (window.outerWidth === 0 || window.outerHeight === 0) {\n        results.detected = true;\n        results.signals.push({name: 'window.dimensions.zero', value: true, weight: 8});\n    }\n\n    // Check for missing screen properties.\n    if (screen.availWidth === 0 || screen.availHeight === 0) {\n        results.signals.push({name: 'screen.dimensions.zero', value: true, weight: 7});\n    }\n\n    // Connection type check (headless often missing).\n    const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;\n    if (connection === undefined && /Chrome/.test(navigator.userAgent)) {\n        results.signals.push({name: 'connection.missing', value: true, weight: 4});\n    }\n\n    // Check for permission API behavior.\n    if (navigator.permissions) {\n        navigator.permissions.query({name: 'notifications'}).then((result) => {\n            // Headless often returns 'denied' instantly without prompting.\n            if (result.state === 'denied') {\n                results.signals.push({name: 'permissions.notifications.denied', value: true, weight: 3});\n            }\n        }).catch(() => {\n            // Ignore permission errors.\n        });\n    }\n\n    results.detected = results.signals.some((s) => s.weight >= 7);\n\n    return results;\n};\n\n/**\n * Detect known automation extensions.\n *\n * @returns {Promise<Object>} Extension detection results.\n */\nconst detectExtensions = async() => {\n    const results = {\n        detected: [],\n        signals: [],\n    };\n\n    // Method 1: Check for extension-injected elements.\n    for (const ext of KNOWN_EXTENSIONS) {\n        // Look for elements with extension-specific classes or IDs.\n        const elements = document.querySelectorAll(`[class*=\"${ext.id}\"], [id*=\"${ext.id}\"]`);\n        if (elements.length > 0) {\n            results.detected.push(ext.name);\n            results.signals.push({\n                name: `extension.dom.${ext.id}`,\n                value: elements.length,\n                weight: ext.weight,\n            });\n        }\n    }\n\n    // Method 2: Check for extension resource accessibility.\n    // Extensions often expose resources at chrome-extension:// URLs.\n    // Note: Direct probing disabled due to CORS restrictions.\n    // Future: Could probe known extension resource URLs.\n\n    // Method 3: Check for MCP-specific patterns.\n    if (typeof window.__MCP_READY !== 'undefined' || document.querySelector('[data-mcp-session]')) {\n        results.detected.push('MCP Protocol');\n        results.signals.push({name: 'mcp.protocol.detected', value: true, weight: 10});\n    }\n\n    // Method 4: Check for Anthropic/Claude-specific globals or patterns.\n    if (window.__CLAUDE_BROWSER_CONTEXT || window.__ANTHROPIC_SESSION) {\n        results.detected.push('Claude Browser Context');\n        results.signals.push({name: 'claude.context.detected', value: true, weight: 10});\n    }\n\n    // Method 5: Scan for injected stylesheets from extensions.\n    const stylesheets = Array.from(document.styleSheets);\n    for (const sheet of stylesheets) {\n        try {\n            if (sheet.href && sheet.href.startsWith('chrome-extension://')) {\n                for (const ext of KNOWN_EXTENSIONS) {\n                    if (ext.pattern.test(sheet.href)) {\n                        results.detected.push(ext.name);\n                        results.signals.push({\n                            name: `extension.stylesheet.${ext.id}`,\n                            value: sheet.href,\n                            weight: ext.weight,\n                        });\n                    }\n                }\n            }\n        } catch (e) {\n            // Cross-origin stylesheet, can't inspect.\n        }\n    }\n\n    return results;\n};\n\n/**\n * Detect automation-related global objects.\n *\n * @returns {Object} Global object detection results.\n */\nconst detectAutomationGlobals = () => {\n    const results = {\n        detected: [],\n        signals: [],\n    };\n\n    for (const global of AUTOMATION_GLOBALS) {\n        if (global.name in window) {\n            results.detected.push(global.name);\n            results.signals.push({\n                name: `global.${global.name}`,\n                value: true,\n                weight: global.weight,\n            });\n        }\n    }\n\n    // Check document properties.\n    const docProps = ['$cdc_asdjflasutopfhvcZLmcfl_', '$chrome_asyncScriptInfo'];\n    for (const prop of docProps) {\n        for (const key of Object.keys(document)) {\n            if (key.startsWith(prop) || key.includes('cdc_') || key.includes('selenium')) {\n                results.detected.push(key);\n                results.signals.push({name: `document.${key}`, value: true, weight: 10});\n            }\n        }\n    }\n\n    return results;\n};\n\n/**\n * Detect DOM markers injected by automation tools.\n *\n * @returns {Object} DOM marker detection results.\n */\nconst detectDomMarkers = () => {\n    const results = {\n        detected: [],\n        signals: [],\n    };\n\n    for (const marker of DOM_MARKERS) {\n        const elements = document.querySelectorAll(marker.selector);\n        for (const el of elements) {\n            const value = el.getAttribute(marker.attribute);\n            if (marker.pattern.test(value)) {\n                results.detected.push(marker.name);\n                results.signals.push({\n                    name: `dom.${marker.attribute}`,\n                    value: value,\n                    weight: marker.weight,\n                });\n            }\n        }\n    }\n\n    return results;\n};\n\n/**\n * Collect canvas fingerprint for headless detection.\n *\n * Headless browsers often have different canvas rendering.\n *\n * @returns {Promise<Object>} Canvas fingerprint data.\n */\nconst collectCanvasFingerprint = async() => {\n    const results = {\n        hash: null,\n        anomalies: [],\n    };\n\n    try {\n        const canvas = document.createElement('canvas');\n        canvas.width = 200;\n        canvas.height = 50;\n        const ctx = canvas.getContext('2d');\n\n        // Draw complex shapes that reveal rendering differences.\n        ctx.textBaseline = 'top';\n        ctx.font = '14px Arial';\n        ctx.fillStyle = '#f60';\n        ctx.fillRect(125, 1, 62, 20);\n        ctx.fillStyle = '#069';\n        ctx.fillText('Agent Detection Test', 2, 15);\n        ctx.fillStyle = 'rgba(102, 204, 0, 0.7)';\n        ctx.fillText('Canvas Fingerprint', 4, 17);\n\n        const dataUrl = canvas.toDataURL();\n        results.hash = await hashString(dataUrl);\n\n        // Check for known headless canvas signatures.\n        if (dataUrl.length < 1000) {\n            results.anomalies.push({name: 'canvas.data.short', weight: 6});\n        }\n\n    } catch (e) {\n        results.anomalies.push({name: 'canvas.error', value: e.message, weight: 5});\n    }\n\n    return results;\n};\n\n/**\n * Collect WebGL renderer information.\n *\n * Headless browsers often report \"SwiftShader\" or unusual renderers.\n *\n * @returns {Object} WebGL information.\n */\nconst collectWebGLInfo = () => {\n    const results = {\n        vendor: null,\n        renderer: null,\n        anomalies: [],\n    };\n\n    try {\n        const canvas = document.createElement('canvas');\n        const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n\n        if (gl) {\n            const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');\n            if (debugInfo) {\n                results.vendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);\n                results.renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);\n\n                // Check for headless indicators.\n                const headlessRenderers = ['SwiftShader', 'llvmpipe', 'Mesa', 'Software'];\n                for (const hr of headlessRenderers) {\n                    if (results.renderer && results.renderer.includes(hr)) {\n                        results.anomalies.push({\n                            name: `webgl.renderer.${hr.toLowerCase()}`,\n                            value: results.renderer,\n                            weight: 8,\n                        });\n                    }\n                }\n            }\n        } else {\n            results.anomalies.push({name: 'webgl.unavailable', weight: 5});\n        }\n    } catch (e) {\n        results.anomalies.push({name: 'webgl.error', value: e.message, weight: 3});\n    }\n\n    return results;\n};\n\n/**\n * Collect navigator information for fingerprinting.\n *\n * @returns {Object} Navigator properties.\n */\nconst collectNavigatorInfo = () => {\n    return {\n        userAgent: navigator.userAgent,\n        platform: navigator.platform,\n        hardwareConcurrency: navigator.hardwareConcurrency,\n        deviceMemory: navigator.deviceMemory,\n        maxTouchPoints: navigator.maxTouchPoints,\n        languages: navigator.languages ? [...navigator.languages] : [],\n        cookieEnabled: navigator.cookieEnabled,\n        doNotTrack: navigator.doNotTrack,\n        pluginCount: navigator.plugins.length,\n    };\n};\n\n/**\n * Calculate overall fingerprint score.\n *\n * @param {Object} signals Collected signals.\n * @returns {number} Score from 0-100 (higher = more likely automated).\n */\nconst calculateFingerprintScore = (signals) => {\n    let totalWeight = 0;\n    let maxWeight = 0;\n\n    // Aggregate all signal weights.\n    const allSignals = [\n        ...(signals.webdriver.signals || []),\n        ...(signals.headless.signals || []),\n        ...(signals.extensions.signals || []),\n        ...(signals.globals.signals || []),\n        ...(signals.domMarkers.signals || []),\n        ...(signals.canvas.anomalies || []),\n        ...(signals.webgl.anomalies || []),\n    ];\n\n    for (const signal of allSignals) {\n        totalWeight += signal.weight || 0;\n        maxWeight += 10; // Max possible weight per signal.\n    }\n\n    // Normalize to 0-100 scale.\n    if (maxWeight === 0) {\n        return 0;\n    }\n\n    // Use sigmoid-like scaling to emphasize high-confidence signals.\n    const rawScore = (totalWeight / Math.max(maxWeight, 50)) * 100;\n    return Math.min(100, Math.round(rawScore));\n};\n\n/**\n * Simple hash function for fingerprint comparison.\n *\n * @param {string} str String to hash.\n * @returns {Promise<string>} Hex hash string.\n */\nconst hashString = async(str) => {\n    const encoder = new TextEncoder();\n    const data = encoder.encode(str);\n    const hashBuffer = await crypto.subtle.digest('SHA-256', data);\n    const hashArray = Array.from(new Uint8Array(hashBuffer));\n    return hashArray.map((b) => b.toString(16).padStart(2, '0')).join('');\n};\n\nexport default {\n    collect,\n    KNOWN_EXTENSIONS,\n    AUTOMATION_GLOBALS,\n};\n"],"names":["KNOWN_EXTENSIONS","id","name","weight","pattern","AUTOMATION_GLOBALS","DOM_MARKERS","selector","attribute","collect","async","signals","timestamp","Date","now","webdriver","detectWebdriver","headless","detectHeadless","extensions","detectExtensions","globals","detectAutomationGlobals","domMarkers","detectDomMarkers","canvas","collectCanvasFingerprint","webgl","collectWebGLInfo","navigator","collectNavigatorInfo","score","calculateFingerprintScore","results","detected","push","value","descriptor","Object","getOwnPropertyDescriptor","Navigator","prototype","get","toString","includes","e","message","plugins","length","languages","undefined","window","chrome","test","userAgent","outerWidth","outerHeight","screen","availWidth","availHeight","connection","mozConnection","webkitConnection","permissions","query","then","result","state","catch","some","s","ext","elements","document","querySelectorAll","__MCP_READY","querySelector","__CLAUDE_BROWSER_CONTEXT","__ANTHROPIC_SESSION","stylesheets","Array","from","styleSheets","sheet","href","startsWith","global","docProps","prop","key","keys","marker","el","getAttribute","hash","anomalies","createElement","width","height","ctx","getContext","textBaseline","font","fillStyle","fillRect","fillText","dataUrl","toDataURL","hashString","vendor","renderer","gl","debugInfo","getExtension","getParameter","UNMASKED_VENDOR_WEBGL","UNMASKED_RENDERER_WEBGL","headlessRenderers","hr","toLowerCase","platform","hardwareConcurrency","deviceMemory","maxTouchPoints","cookieEnabled","doNotTrack","pluginCount","totalWeight","maxWeight","allSignals","signal","rawScore","Math","max","min","round","data","TextEncoder","encode","str","hashBuffer","crypto","subtle","digest","Uint8Array","map","b","padStart","join"],"mappings":"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"}