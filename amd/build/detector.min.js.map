{"version":3,"file":"detector.min.js","sources":["../src/detector.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Main agent detection module.\n *\n * Orchestrates fingerprint and interaction detection, combines results,\n * and reports to the Moodle backend.\n *\n * @module     local_agentdetect/detector\n * @copyright  2024 Your Institution\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport * as Fingerprint from 'local_agentdetect/fingerprint';\nimport * as Interaction from 'local_agentdetect/interaction';\nimport * as Injection from 'local_agentdetect/injection';\nimport Ajax from 'core/ajax';\nimport Log from 'core/log';\n\n/**\n * Configuration passed from PHP.\n *\n * @type {Object}\n */\nlet config = {\n    enabled: true,\n    reportInterval: 30000, // Ms - how often to report to server.\n    minReportScore: 10, // Minimum combined score to report.\n    contextId: null,\n    sessionKey: null,\n    debug: false,\n};\n\n/**\n * Report timer reference.\n *\n * @type {number|null}\n */\nlet reportTimer = null;\n\n/**\n * Session ID for this detection session.\n * Persisted in sessionStorage to survive page navigations within a quiz.\n *\n * @type {string}\n */\nlet sessionId = null;\n\n/**\n * Maximum age (ms) for a reusable session ID from sessionStorage.\n *\n * @type {number}\n */\nconst SESSION_MAX_AGE = 30 * 60 * 1000; // 30 minutes.\n\n/**\n * Whether detection has been initialized.\n *\n * @type {boolean}\n */\nlet initialized = false;\n\n/**\n * Initialize the agent detection system.\n *\n * @param {Object} options Configuration options from PHP.\n * @returns {Promise<void>}\n */\nexport const init = async(options = {}) => {\n    if (initialized) {\n        Log.debug('[AgentDetect] Already initialized');\n        return;\n    }\n\n    // Merge config.\n    config = {...config, ...options};\n\n    if (!config.enabled) {\n        Log.debug('[AgentDetect] Detection disabled');\n        return;\n    }\n\n    // Restore or generate session ID (persists across page loads within same tab).\n    sessionId = restoreOrCreateSessionId();\n\n    Log.debug('[AgentDetect] Initializing detection', {sessionId, config});\n\n    // Start interaction monitoring with context for cross-page accumulation.\n    Interaction.startMonitoring({contextId: config.contextId});\n\n    // Start injection detection (watches for AI helper UI injected by extensions).\n    Injection.startMonitoring({debug: config.debug});\n\n    // Collect initial fingerprint.\n    const initialFingerprint = await Fingerprint.collect();\n\n    if (config.debug) {\n        Log.debug('[AgentDetect] Initial fingerprint:', initialFingerprint);\n    }\n\n    // If fingerprint score is high, report immediately.\n    if (initialFingerprint.score >= config.minReportScore) {\n        await reportSignals({\n            type: 'fingerprint',\n            data: initialFingerprint,\n        });\n    }\n\n    // Start periodic reporting.\n    startPeriodicReporting();\n\n    // Report on page unload.\n    window.addEventListener('beforeunload', handlePageUnload);\n\n    // Report on visibility change (tab switching).\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n\n    initialized = true;\n    Log.debug('[AgentDetect] Initialization complete');\n};\n\n/**\n * Generate a unique session ID.\n *\n * @returns {string} Session ID.\n */\nconst generateSessionId = () => {\n    const timestamp = Date.now().toString(36);\n    const random = Math.random().toString(36).substring(2, 10);\n    return `${timestamp}-${random}`;\n};\n\n/**\n * Restore session ID from sessionStorage or create a new one.\n * This allows the same session to span multiple page loads within a quiz.\n *\n * @returns {string} Session ID.\n */\nconst restoreOrCreateSessionId = () => {\n    const storageKey = 'agentdetect_session';\n    try {\n        const stored = sessionStorage.getItem(storageKey);\n        if (stored) {\n            const parsed = JSON.parse(stored);\n            const age = Date.now() - (parsed.timestamp || 0);\n            if (age < SESSION_MAX_AGE && parsed.id) {\n                Log.debug('[AgentDetect] Restored session ID from prior page', parsed.id);\n                return parsed.id;\n            }\n        }\n    } catch (e) {\n        // SessionStorage unavailable or corrupt — generate fresh.\n    }\n\n    const newId = generateSessionId();\n    try {\n        sessionStorage.setItem(storageKey, JSON.stringify({id: newId, timestamp: Date.now()}));\n    } catch (e) {\n        // Ignore storage errors.\n    }\n    return newId;\n};\n\n/**\n * Start periodic reporting to the server.\n *\n * @returns {void}\n */\nconst startPeriodicReporting = () => {\n    if (reportTimer) {\n        clearInterval(reportTimer);\n    }\n\n    reportTimer = setInterval(async() => {\n        await collectAndReport();\n    }, config.reportInterval);\n};\n\n/**\n * Stop periodic reporting.\n *\n * @returns {void}\n */\nconst stopPeriodicReporting = () => {\n    if (reportTimer) {\n        clearInterval(reportTimer);\n        reportTimer = null;\n    }\n};\n\n/**\n * Collect all signals and report to server.\n *\n * @returns {Promise<Object>} Combined analysis results.\n */\nexport const collectAndReport = async() => {\n    // Collect fingerprint.\n    const fingerprint = await Fingerprint.collect();\n\n    // Analyze interactions.\n    const interaction = Interaction.analyze();\n\n    // Analyze injected content (AI helper extensions).\n    const injection = Injection.analyze();\n\n    // Extract Comet agentic mode signals from all sub-modules.\n    const comet = extractCometSignals(fingerprint, interaction, injection);\n\n    // Combine scores.\n    const combinedScore = calculateCombinedScore(fingerprint.score, interaction.score, injection.score, comet.score);\n\n    const result = {\n        sessionId,\n        timestamp: Date.now(),\n        pageUrl: window.location.href,\n        pageTitle: document.title,\n        fingerprint,\n        interaction,\n        injection,\n        comet,\n        combinedScore,\n        verdict: getVerdict(combinedScore),\n        detectedAgent: comet.detected ? 'comet_agentic' : null,\n    };\n\n    if (config.debug) {\n        Log.debug('[AgentDetect] Analysis result:', result);\n    }\n\n    // Only report if score meets threshold.\n    if (combinedScore >= config.minReportScore) {\n        await reportSignals({\n            type: 'combined',\n            data: result,\n        });\n    }\n\n    return result;\n};\n\n/**\n * Calculate combined score from fingerprint, interaction, injection, and Comet signals.\n *\n * Interaction score is the primary signal (catches human-driven AI tool usage).\n * Injection score adds evidence of AI helper extensions being present.\n * Fingerprint score is a bonus when detected (catches automated headless browsers).\n * Comet score is a definitive category for Perplexity Comet agentic mode.\n *\n * @param {number} fingerprintScore Fingerprint score (0-100).\n * @param {number} interactionScore Interaction score (0-100).\n * @param {number} injectionScore Injection detection score (0-100).\n * @param {number} cometScore Comet agentic mode score (0-100).\n * @returns {number} Combined score (0-100).\n */\nconst calculateCombinedScore = (fingerprintScore, interactionScore, injectionScore = 0, cometScore = 0) => {\n    // Interaction is the base score - it catches both:\n    // 1. Automated agents (teleport clicks, superhuman speed)\n    // 2. Human-driven AI usage (tab switches, copy-paste patterns, pauses)\n    let score = interactionScore;\n\n    // Injection detection adds to the score - catches AI helper extensions.\n    // This is direct evidence of tools being present on the page.\n    if (injectionScore >= 50) {\n        // Strong injection signals - significant boost.\n        score = Math.min(100, score + 25);\n    } else if (injectionScore >= 25) {\n        // Moderate injection signals - modest boost.\n        score = Math.min(100, score + 15);\n    } else if (injectionScore >= 10) {\n        // Weak injection signals - small boost.\n        score = Math.min(100, score + 5);\n    }\n\n    // Fingerprint is a bonus - only helps when it detects something.\n    // This catches headless browsers, automation tools with webdriver flag, etc.\n    // Modern extension-based AI tools won't trigger fingerprint, and that's OK.\n    if (fingerprintScore >= 70) {\n        // Strong automation fingerprint - significant boost.\n        score = Math.min(100, score + 30);\n    } else if (fingerprintScore >= 40) {\n        // Moderate fingerprint signals - modest boost.\n        score = Math.min(100, score + 15);\n    } else if (fingerprintScore >= 20) {\n        // Weak fingerprint signals - small boost.\n        score = Math.min(100, score + 5);\n    }\n    // If fingerprint is 0-19, no adjustment - interaction score stands alone.\n\n    // Comet agentic mode signals — definitive category.\n    if (cometScore >= 70) {\n        // Strong Comet agentic evidence — ensure HIGH_CONFIDENCE.\n        score = Math.max(score, 80);\n        score = Math.min(100, score + 10);\n    } else if (cometScore >= 40) {\n        // Moderate Comet signals — significant boost.\n        score = Math.min(100, score + 25);\n    } else if (cometScore >= 20) {\n        // Weak Comet signals — modest boost.\n        score = Math.min(100, score + 10);\n    }\n\n    return Math.round(score);\n};\n\n/**\n * Extract Comet-specific signals from all detection sub-modules.\n *\n * @param {Object} fingerprint Fingerprint results.\n * @param {Object} interaction Interaction analysis results.\n * @param {Object} injection Injection analysis results.\n * @returns {Object} Comet detection summary with signals and score.\n */\nconst extractCometSignals = (fingerprint, interaction, injection) => {\n    const signals = [];\n\n    // From fingerprint: Comet extension probing, runtime artifacts, and webdriver change.\n    if (fingerprint.cometExtension) {\n        signals.push(...(fingerprint.cometExtension.signals || []));\n    }\n    if (fingerprint.cometRuntime) {\n        signals.push(...(fingerprint.cometRuntime.signals || []));\n    }\n    if (fingerprint.perplexityNetwork) {\n        signals.push(...(fingerprint.perplexityNetwork.signals || []));\n    }\n    // Webdriver mid-session change (debugger attachment).\n    const webdriverChange = (fingerprint.webdriver?.signals || []).find(\n        (s) => s.name === 'webdriver.changed_mid_session'\n    );\n    if (webdriverChange) {\n        signals.push(webdriverChange);\n    }\n\n    // From interaction: comet-prefixed anomalies.\n    const cometAnomalies = (interaction.anomalies || []).filter(\n        (a) => a.name.startsWith('comet.')\n    );\n    signals.push(...cometAnomalies);\n\n    // From injection: Comet-specific findings.\n    const cometInjections = (injection.signals || []).filter(\n        (s) => s.name.includes('comet') || s.name.includes('perplexity') ||\n               s.name.includes('npclhjbddhklpbnacpjloidibaggcgon')\n    );\n    signals.push(...cometInjections);\n\n    return {\n        detected: signals.length > 0,\n        signalCount: signals.length,\n        signals,\n        score: calculateCometScore(signals),\n    };\n};\n\n/**\n * Calculate Comet agentic mode score from extracted signals.\n *\n * @param {Array} signals Comet-specific signals.\n * @returns {number} Score from 0-100.\n */\nconst calculateCometScore = (signals) => {\n    if (signals.length === 0) {\n        return 0;\n    }\n\n    const totalWeight = signals.reduce((sum, s) => sum + (s.weight || s.maxWeight || 0), 0);\n\n    // Definitive signals = immediate high score.\n    const hasDefinitiveSignal = signals.some((s) =>\n        s.name === 'comet_overlay_js' ||\n        s.name === 'comet.extension.script_injected' ||\n        s.name === 'comet.extension.resource_probe' ||\n        s.name === 'comet_agent_src' ||\n        s.name === 'network.perplexity_agent' ||\n        s.name.startsWith('comet.runtime.')\n    );\n\n    if (hasDefinitiveSignal) {\n        return Math.min(100, 70 + totalWeight);\n    }\n\n    // Multiple behavioral signals compound.\n    const behavioralSignals = signals.filter((s) => s.name.startsWith('comet.'));\n    if (behavioralSignals.length >= 3) {\n        return Math.min(100, totalWeight * 2);\n    }\n\n    return Math.min(100, totalWeight);\n};\n\n/**\n * Get human-readable verdict from score.\n *\n * @param {number} score Combined score.\n * @returns {string} Verdict string.\n */\nconst getVerdict = (score) => {\n    if (score >= 80) {\n        return 'HIGH_CONFIDENCE_AGENT';\n    } else if (score >= 60) {\n        return 'PROBABLE_AGENT';\n    } else if (score >= 40) {\n        return 'SUSPICIOUS';\n    } else if (score >= 20) {\n        return 'LOW_SUSPICION';\n    }\n    return 'LIKELY_HUMAN';\n};\n\n/**\n * Report signals to the Moodle backend.\n *\n * @param {Object} payload Signal data to report.\n * @returns {Promise<void>}\n */\nconst reportSignals = async(payload) => {\n    if (!config.sessionKey) {\n        Log.warn('[AgentDetect] No session key configured, skipping report');\n        return;\n    }\n\n    try {\n        const response = await Ajax.call([{\n            methodname: 'local_agentdetect_report_signals',\n            args: {\n                sesskey: config.sessionKey,\n                contextid: config.contextId,\n                sessionid: sessionId,\n                signaltype: payload.type,\n                signaldata: JSON.stringify(payload.data),\n            },\n        }])[0];\n\n        if (config.debug) {\n            Log.debug('[AgentDetect] Report response:', response);\n        }\n    } catch (error) {\n        Log.error('[AgentDetect] Failed to report signals:', error);\n    }\n};\n\n/**\n * Handle page unload - save state for cross-page continuity and send final report.\n *\n * @returns {void}\n */\nconst handlePageUnload = () => {\n    // Save interaction events to sessionStorage for cross-page accumulation.\n    Interaction.saveToSessionStorage();\n\n    // Use sendBeacon for reliable delivery during unload.\n    if (navigator.sendBeacon && config.sessionKey) {\n        const interaction = Interaction.analyze();\n        const payload = {\n            sesskey: config.sessionKey,\n            contextid: config.contextId,\n            sessionid: sessionId,\n            signaltype: 'unload',\n            signaldata: JSON.stringify({\n                pageUrl: window.location.href,\n                pageTitle: document.title,\n                interaction,\n                duration: Date.now() - (Interaction.getRawData().startTime || Date.now()),\n            }),\n        };\n\n        const url = M.cfg.wwwroot + '/local/agentdetect/beacon.php';\n        navigator.sendBeacon(url, JSON.stringify(payload));\n    }\n};\n\n/**\n * Handle visibility change - report when tab loses focus.\n *\n * @returns {void}\n */\nconst handleVisibilityChange = async() => {\n    if (document.visibilityState === 'hidden') {\n        // Tab lost focus - good time to report.\n        await collectAndReport();\n    }\n};\n\n/**\n * Manually trigger detection analysis.\n *\n * Useful for testing or on-demand checks.\n *\n * @returns {Promise<Object>} Analysis results.\n */\nexport const runAnalysis = async() => {\n    return await collectAndReport();\n};\n\n/**\n * Get current detection status.\n *\n * @returns {Object} Status information.\n */\nexport const getStatus = () => {\n    return {\n        initialized,\n        sessionId,\n        isMonitoring: Interaction.getRawData().isMonitoring,\n        config: {\n            enabled: config.enabled,\n            reportInterval: config.reportInterval,\n            minReportScore: config.minReportScore,\n        },\n    };\n};\n\n/**\n * Shutdown detection and cleanup.\n *\n * @returns {void}\n */\nexport const shutdown = () => {\n    stopPeriodicReporting();\n    Interaction.stopMonitoring();\n    Injection.stopMonitoring();\n    window.removeEventListener('beforeunload', handlePageUnload);\n    document.removeEventListener('visibilitychange', handleVisibilityChange);\n    initialized = false;\n    Log.debug('[AgentDetect] Shutdown complete');\n};\n\nexport default {\n    init,\n    runAnalysis,\n    getStatus,\n    shutdown,\n    collectAndReport,\n};\n"],"names":["config","enabled","reportInterval","minReportScore","contextId","sessionKey","debug","reportTimer","sessionId","initialized","init","async","options","restoreOrCreateSessionId","Interaction","startMonitoring","Injection","initialFingerprint","Fingerprint","collect","score","reportSignals","type","data","startPeriodicReporting","window","addEventListener","handlePageUnload","document","handleVisibilityChange","stored","sessionStorage","getItem","parsed","JSON","parse","Date","now","timestamp","id","e","newId","toString","Math","random","substring","setItem","stringify","clearInterval","setInterval","collectAndReport","fingerprint","interaction","analyze","injection","comet","extractCometSignals","combinedScore","calculateCombinedScore","result","pageUrl","location","href","pageTitle","title","verdict","getVerdict","detectedAgent","detected","fingerprintScore","interactionScore","injectionScore","cometScore","min","max","round","signals","cometExtension","push","cometRuntime","perplexityNetwork","webdriverChange","webdriver","find","s","name","cometAnomalies","anomalies","filter","a","startsWith","cometInjections","includes","length","signalCount","calculateCometScore","totalWeight","reduce","sum","weight","maxWeight","some","response","Ajax","call","methodname","args","sesskey","contextid","sessionid","signaltype","payload","signaldata","error","warn","saveToSessionStorage","navigator","sendBeacon","duration","getRawData","startTime","url","M","cfg","wwwroot","visibilityState","runAnalysis","getStatus","isMonitoring","shutdown","stopMonitoring","removeEventListener"],"mappings":"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"}